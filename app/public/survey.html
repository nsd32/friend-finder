<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
    
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- jQuery -->
    <script
    src="https://code.jquery.com/jquery-3.2.1.js"
    integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
    crossorigin="anonymous"></script>

  </head>

  <style type="text/css">
      img {
        max-width: 100%;
        height: auto;
      }

      #submit-btn {
        background-color: #004080;
      }

      a {
        color: #004080;
      }

      #name, #photo {
        box-shadow: 2px 2px grey;
      }
    </style>

  <body>
    <div class="container"><br />

      <div class="row">
        <div class="col-12">
          <h2>Survey Questions</h2>
          <hr class="my-4">
        </div> <!-- column -->
      </div> <!-- row -->

      <div class="row">
        <div class="col-12">
          <form>

            <div class="form-group">
              <h2>About You</h2>
              <h5><label class="form-control-label" for="name">Name (Required)</label></h5>
              <input type="text" class="form-control" id="name">
            </div>
            <div class="form-group">
              <h5><label class="form-control-label" for="photo">Link to Photo Image (Required)</label></h5>
              <input type="text" class="form-control" id="photo">
            </div>
            <hr class="my-4">

            <div class="form-group">
              <h2>Question 1</h2>
              <label for="exampleFormControlSelect1">You like dogs more than cats.</label><br />
              <select id="question-one">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 2</h2>
              <label for="exampleFormControlSelect1">You like Netflix more than Hulu.</label><br />
              <select id="question-two">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="4">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 3</h2>
              <label for="exampleFormControlSelect1">You like Facebook more than Twitter.</label><br />
              <select id="question-three">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 4</h2>
              <label for="exampleFormControlSelect1">While walking, you like Music over a Podcast.</label><br />
              <select id="question-four">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 5</h2>
              <label for="exampleFormControlSelect1">You like iOS over Android.</label><br />
              <select id="question-five">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 6</h2>
              <label for="exampleFormControlSelect1">You like a big party over a small gathering.</label><br />
              <select id="question-six">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 7</h2>
              <label for="exampleFormControlSelect1">You'd rather do laundry than dishes.</label><br />
              <select id="question-seven">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 8</h2>
              <label for="exampleFormControlSelect1">You'd rather have a lot of money than a lot of free time.</label><br />
              <select id="question-eight">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 9</h2>
              <label for="exampleFormControlSelect1">You like pancakes more than waffles.</label><br />
              <select id="question-nine">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 10</h2>
              <label for="exampleFormControlSelect1">You like hot coffee more than iced coffee.</label><br />
              <select id="question-ten">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <button type="button" id="submit-btn" class="btn btn-primary btn-lg btn-block">Submit</button>

            <hr class="my-4">

          </form>
        </div>
      </div>

      <div class="row">
        <div class="col-12">
          <a href="/api/friends">API Friends List</a>
          <span> | </span>
          <a href="https://github.com/nsd32/friend-finder" target="_blank">GitHub Repo</a>
        </div> <!-- column --> 
      </div> <!-- row -->
      <br />

      <div id="friend-modal" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 id="friend-modal-title" class="modal-title">You have a match!</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <img id="friend-image" src="">  
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>

      <div id="error-modal" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 id="error-modal-title" class="modal-title">Error!</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div id="error-modal-body" class="modal-body">
              <p>Please fill out all fields before submitting!</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>

    </div> <!-- container -->

    <script type="text/javascript">
      
      $('#submit-btn').click(function(event) {
        event.preventDefault();

        var questions = [$('#question-one'), $('#question-two'), $('#question-three'), $('#question-four'), $('#question-five'), $('#question-six'), $('#question-seven'), $('#question-eight'), $('#question-nine'), $('#question-ten')]

        if ($('#name').val() === '' || $('#photo').val() === '') {
          $('#error-modal').modal('show');
          return;
        }

        for (let i = 0; i < questions.length; i++) {
          if (questions[i].val() === 'Select an option') {
            $('#error-modal').modal('show');
            return;
          }
        }

        var one = $('#question-one').val();
        var two = $('#question-two').val();
        var three = $('#question-three').val();
        var four = $('#question-four').val();
        var five = $('#question-five').val();
        var six = $('#question-six').val();
        var seven = $('#question-seven').val();
        var eight = $('#question-eight').val();
        var nine = $('#question-nine').val();
        var ten = $('#question-ten').val();

        var name = $('#name').val();
        var photo = $('#photo').val();

        var newFriend = {
          name: name,
          photo: photo,
          scores: [one, two, three, four, five, six, seven, eight, nine, ten]
        };

        let currentURL = window.location.origin

        $.post({
          url: currentURL + '/api/friends',
          contentType: 'application/json'
        }, JSON.stringify(newFriend))
        .done(function(data) {
          console.log(data);
          
          $('#friend-modal-body').append(`<p>${data.name}</p>`);
          $('#friend-image').attr('src', data.photo);
          $('#friend-modal').modal('show');

        })
        
        $('#name').val('');
        $('#photo').val('');
        //$('#my_select').get(0).selectedIndex = 1;
        $('#question-one').get(0).selectedIndex = 0;
        $('#question-two').get(0).selectedIndex = 0;
        $('#question-three').get(0).selectedIndex = 0;
        $('#question-four').get(0).selectedIndex = 0;
        $('#question-five').get(0).selectedIndex = 0;
        $('#question-six').get(0).selectedIndex = 0;
        $('#question-seven').get(0).selectedIndex = 0;
        $('#question-eight').get(0).selectedIndex = 0;
        $('#question-nine').get(0).selectedIndex = 0;
        $('#question-ten').get(0).selectedIndex = 0;

      }); 

    </script>


    <!-- Optional JavaScript --> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
  </body>
</html>