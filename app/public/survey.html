<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
    
    <!-- jQuery -->
    <script
    src="https://code.jquery.com/jquery-3.2.1.js"
    integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
    crossorigin="anonymous"></script>

  </head>
  <body>
    <div class="container"><br />

      <div class="row">
        <div class="col-12">
          <h2>Survey Questions</h2>
          <hr class="my-4">
        </div> <!-- column -->
      </div> <!-- row -->

      <div class="row">
        <div class="col-12">
          <form>

            <div class="form-group">
              <h2>About You</h2>
              <h5><label class="form-control-label" for="name">Name (Required)</label></h5>
              <input type="text" class="form-control" id="name" placeholder="Example input">
            </div>
            <div class="form-group">
              <h5><label class="form-control-label" for="photo">Link to Photo Image (Required)</label></h5>
              <input type="text" class="form-control" id="photo" placeholder="Another input">
            </div>
            <hr class="my-4">

            <div class="form-group">
              <h2>Question 1</h2>
              <label for="exampleFormControlSelect1">Example select</label>
              <select class="form-control custom-select" id="question-one">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 2</h2>
              <label for="exampleFormControlSelect1">Example select</label>
              <select class="form-control custom-select" id="question-two">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="4">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 3</h2>
              <label for="exampleFormControlSelect1">Example select</label>
              <select class="form-control custom-select" id="question-three">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 4</h2>
              <label for="exampleFormControlSelect1">Example select</label>
              <select class="form-control custom-select" id="question-four">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 5</h2>
              <label for="exampleFormControlSelect1">Example select</label>
              <select class="form-control custom-select" id="question-five">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 6</h2>
              <label for="exampleFormControlSelect1">Example select</label>
              <select class="form-control custom-select" id="question-six">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 7</h2>
              <label for="exampleFormControlSelect1">Example select</label>
              <select class="form-control custom-select" id="question-seven">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 8</h2>
              <label for="exampleFormControlSelect1">Example select</label>
              <select class="form-control custom-select" id="question-eight">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 9</h2>
              <label for="exampleFormControlSelect1">Example select</label>
              <select class="form-control custom-select" id="question-nine">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <div class="form-group">
              <h2>Question 10</h2>
              <label for="exampleFormControlSelect1">Example select</label>
              <select class="form-control custom-select" id="question-ten">
                <option selected>Select an option</option>
                <option value="1">1 (Strongly Disagree)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Strongly Agree)</option>
              </select>
            </div>

            <button type="button" id="submit-btn" class="btn btn-primary btn-lg btn-block">Submit</button>

            <hr class="my-4">

          </form>
        </div>
      </div>

      <div class="row">
        <div class="col-12">
          <a href="/api/friends">API Friends List</a>
          <span> | </span>
          <a href="https://github.com/nsd32/friend-finder" target="_blank">GitHub Repo</a>
        </div> <!-- column --> 
      </div> <!-- row -->
      <br />

    </div> <!-- container -->

    <script type="text/javascript">

      $('#clear').click(function() {
        let currentURL = window.location.origin
        $.ajax({
          url: currentURL + "/api/clear",
          method: "POST"
        }); 
      });

      
      $('#submit-btn').click(function(event) {
      event.preventDefault();

        var one = $('#question-one').val();
        var two = $('#question-two').val();
        var three = $('#question-three').val();
        var four = $('#question-four').val();
        var five = $('#question-five').val();
        var six = $('#question-six').val();
        var seven = $('#question-seven').val();
        var eight = $('#question-eight').val();
        var nine = $('#question-nine').val();
        var ten = $('#question-ten').val();

        var name = $('#name').val();
        var photo = $('#photo').val();

        var newFriend = {
          name: name,
          photo: photo,
          scores: [one, two, three, four, five, six, seven, eight, nine, ten]
        };

        let currentURL = window.location.origin

        $.post({
          url: currentURL + '/api/friends',
          contentType: 'application/json'
        }, JSON.stringify(newFriend));

        $('#name').val('');
        $('#photo').val('');
        $('#question-one').val('');
        $('#question-two').val('');
        $('#question-three').val('');
        $('#question-four').val('');
        $('#question-five').val('');
        $('#question-six').val('');
        $('#question-seven').val('');
        $('#question-eight').val('');
        $('#question-nine').val('');
        $('#question-ten').val('');

        $.get('/api/friends', function(data) {
            // console.log(data[0])
          var index = 0;
          var smallestTotal = 0;

          for (let k = 0; k < data[0].scores.length; k++) {
            smallestTotal += Math.abs(newFriend.scores[k] - data[0].scores[k]);
          }

          for (let i = 1; i < data.length - 1; i++) {
            for (let j = 0; j < data[i].scores.length; j++) {
              var currentTotal = 0;
              currentTotal += Math.abs(data[i].scores[j] - newFriend.scores[j])

              if (currentTotal < smallestTotal) {
                smallestTotal = currentTotal;
                index = i;
              }
            }
          }
            
        });

      });

      

    </script>

    <!-- Optional JavaScript --> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
  </body>
</html>